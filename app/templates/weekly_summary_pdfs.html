{% extends "layout.html" %}
{% block title %}Weekly Summary PDFs{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/weekly_summary_pdfs.css') }}">
{% endblock %}

{% block content %}
<h2>Weekly Summary PDFs</h2>

<div class="tech-grid">
  {% for tech in techs %}
  <div class="tech-card" id="tech-{{ tech.id }}">
    <button class="tech-circle" data-tech-id="{{ tech.id }}">{{ tech.name }}</button>

    <!-- Hidden div showing PDFs and generate button -->
    <div class="pdf-list" id="pdf-list-{{ tech.id }}" style="display:none;">
      <ul>
        {% for pdf in get_pdfs_for_tech(tech.id) %}
        <li>
          {{ pdf }} 
          <a href="{{ url_for('main.download_pdf', filename=pdf) }}" class="download-btn">Download</a>
        </li>
        {% endfor %}
      </ul>
      <form method="POST" action="{{ url_for('main.generate_weekly_summary', tech_id=tech.id) }}">
        <button type="submit" class="generate-btn">Generate PDF</button>
      </form>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
document.querySelectorAll('.tech-circle').forEach(btn => {
    btn.addEventListener('click', () => {
        const techId = btn.dataset.techId;
        const div = document.getElementById(`pdf-list-${techId}`);
        if (div.style.display === "none") {
            div.style.display = "block";
            div.style.animation = "fadeIn 0.5s forwards";
        } else {
            div.style.display = "none";
        }
    });
});
</script>
{% endblock %}
