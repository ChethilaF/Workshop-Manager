{% extends "layout.html" %}

{% block title %}Jobs Waiting Approval{% endblock %}

{% block extra_css %}
<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Page-specific CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/waiting_approval.css') }}">
{% endblock %}

{% block content %}
<div class="approval-jobs">
  <h2>Jobs Waiting for Approval</h2>

  {% if jobs %}
  <ul class="approval-list">
    {% for job in jobs %}
    <li class="approval-item">
      <!-- Job information -->
      <div class="job-info">
        <strong>{{ job.description }}</strong><br>
        <small><i class="fas fa-car"></i> Vehicle: {{ job.vehicle_registration }}</small><br>
        <small><i class="fas fa-wrench"></i> Technician: {{ job.technician.name }}</small><br>
        <small><i class="fas fa-user"></i> Customer: {{ job.customer.name }}</small><br>
        <small><i class="fas fa-clock"></i> Duration: {{ job.total_work_duration }} seconds</small>
      </div>

      <!-- Action buttons -->
      <div class="job-actions">
        <!-- Confirm/Approve Job -->
        <form method="POST" action="{{ url_for('main.approve_job', job_id=job.id) }}">
          <button type="submit" class="btn-confirm" aria-label="Confirm job {{ job.description }}">
            <i class="fas fa-check"></i> Confirm Job
          </button>
        </form>

        <!-- Retry Job -->
        <form method="POST" action="{{ url_for('main.retry_job', job_id=job.id) }}">
          <button type="submit" class="btn-retry" aria-label="Retry job {{ job.description }}">
            <i class="fas fa-undo"></i> Retry Job
          </button>
        </form>
      </div>
    </li>
    {% endfor %}
  </ul>

  {% else %}
  <p>No jobs waiting for approval.</p>
  {% endif %}
</div>
{% endblock %}
