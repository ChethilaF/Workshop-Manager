{% extends "layout.html" %}
{% block title %}Customers{% endblock %}

{% block extra_css %}
<!-- Font Awesome icons -->
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Page-specific CSS -->
<link rel="stylesheet"
      href="{{ url_for('static', filename='css/customers.css') }}">
{% endblock %}

{% block content %}
<h2>Customer List</h2>

{% if current_user.role == 'admin' %}
<!-- Admin-only action bar for adding new customers -->
<div class="action-bar">
  <a href="{{ url_for('main.add_customer') }}"
     class="add-customer-btn"
     aria-label="Add a new customer">
    <i class="fas fa-user-plus"></i> Add New Customer
  </a>
</div>
{% endif %}

<!-- Customer list -->
{% if customers %}
<ul class="customer-list">
  {% for customer in customers %}
  <li class="customer-item"
      tabindex="0"
      aria-label="Customer {{ customer.full_name }}">
      
    <!-- Customer info -->
    <div class="customer-info">
      <span><strong>{{ customer.full_name }}</strong></span><br>
      {% if customer.email %}<small>| {{ customer.email }}</small>{% endif %}
      {% if customer.phone %}<small>| {{ customer.phone }}</small>{% endif %}
      {% if customer.address %}<small>| {{ customer.address }}</small>{% endif %}
    </div>

    {% if current_user.role == 'admin' %}
    <!-- Admin-only actions: Edit and Delete -->
    <div class="customer-actions">
      <a href="{{ url_for('main.edit_customer', customer_id=customer.id) }}"
         class="edit-button"
         aria-label="Edit customer {{ customer.full_name }}">
        <i class="fas fa-edit"></i> Edit
      </a>
      <form action="{{ url_for('main.delete_customer', id=customer.id) }}"
            method="POST"
            class="delete-form">
        <button type="submit"
                onclick="return confirm('Are you sure you want to delete {{ customer.full_name }}?')"
                class="delete-button"
                aria-label="Delete customer {{ customer.full_name }}">
          <i class="fas fa-trash"></i> Delete
        </button>
      </form>
    </div>
    {% endif %}
  </li>
  {% endfor %}
</ul>
{% else %}
<p>No customers have been added. Please add a new customer to get started.</p>
{% endif %}

{% endblock %}
